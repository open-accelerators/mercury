# camel-k: language=yaml
# camel-k: dependency=mvn:com.redhat.mercury:mercury-camel:1.0.1-SNAPSHOT

- from:
    uri: direct:command
    steps:
      - to: grpc://{{mercury.binding.service.host}}:{{mercury.binding.service.port}}/org.bian.protobuf.BindingService?synchronous=true&method=command
      - set-body:
          constant: ""
      - set-header:
          name: CamelHttpResponseCode
          constant: "202"
- from:
    uri: direct:query
    steps:
    - to: grpc://{{mercury.binding.service.host}}:{{mercury.binding.service.port}}/org.bian.protobuf.BindingService?synchronous=true&method=query
    - to: direct:print
    - choice:
        when:
            - simple: "${body} == null"
              steps:
                - set-header:
                    name: CamelHttpResponseCode
                    constant: "404"